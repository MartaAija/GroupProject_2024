<!--WORKED ON THIS FILE 
 - DOMINIC JOBSON (w1892005)
 - Noel Varga (w1932378) - (added admin view and current user validation)
-->


{% load static %}
<!--RETRIEVE THE TYPE OF USER-->
{% with userType=currentUser.is_superuser %}

<head>
    <title>{% block title %} ACCOUNT {% endblock %}</title>
    <meta charset = "UTF-8">
    <meta name = "viewport" content = "width = device-width, initial-scale = 1.0">
    <link rel = "stylesheet" type = "text/css" href = "{% static 'styles.css' %}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel = "icon" href = "../static/css/logo.jpg">
    
</head>
<body> 
    
    <div class = "container" >
        <h1>Welcome, {{user.username}}</h1> 
        <div class = "content-container">
        {%block content%}
            <!--
            --(CHECKS FOR USER TYPE [USER])-------------------------------------------------------------------
                -> USER VIEW/FUNCTIONALITY
            -->
            {% if userType == False %}
                <form method="POST" action="{% url 'update_user' %}">
                    <center>
                    {% csrf_token %}
                    {{user_form.first_name}}
                    <br/><br/>
                    {{user_form.last_name}}
                    <br/><br/>
                    {{user_form.email}}
                    <br/><br/>
                    <button type="submit" class="btn-btn-success">SAVE</button><br/><br/>
                    </center>
                <br/> <br/>
                </form>
                <div class="button-container">
                    <button onclick="redirectToUserProfile()">User Profile</button>
                    <button onclick="redirectToUserInfo()">User Details</button>
                </div>
            {% elif userType == True %}
                <form method="POST" action="{% url 'update_user' %}">
                    <center>
                    {% csrf_token %}
                    {{user_form.first_name}}
                    <br/><br/>
                    {{user_form.last_name}}
                    <br/><br/>
                    {{user_form.email}}
                    <br/><br/>
                    <button type="submit" class="btn-btn-success">SAVE</button><br/><br/>
                    </center>
                <br/> <br/>
                </form>
                <div class="button-container">
                    <button onclick="redirectToUserProfile()">User Profile</button>
                </div>
            <!--
            --(CHECKS FOR USER TYPE [USER TYPE ERROR])---------------------------------------------------------
                 -> ERROR VIEW
            -->
            {% else %}
            <h2>ERROR 401: Unauthorised access! User authentication is required!</h2>
            {% endif %}                  
        {% endblock%}
        </div>
    </div>
</body>

{% endwith %}

<script>
    function redirectToUserProfile() {
        window.location.href = "{% url 'update_user' %}";
    }

    function redirectToUserInfo() {
        window.location.href = "{% url 'user_info' %}";
    }
</script>